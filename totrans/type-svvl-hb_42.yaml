- en: 配列から型を生成する
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://typescriptbook.jp/tips/generates-type-from-array](https://typescriptbook.jp/tips/generates-type-from-array)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 単位のように振る舞うことを期待されて定義されたコレクションは少なくないでしょう。今回はコレクションでも主に配列に焦点を当てそれらから型を生成する方法の紹介です。
  prefs: []
  type: TYPE_NORMAL
- en: 通貨の配列から通貨の型を作りたい[​](#通貨の配列から通貨の型を作りたい "通貨の配列から通貨の型を作りたい への直接リンク")
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 国際的な外貨を使うことができるサービスを開発していたとします。サポートしている通貨を配列で保持しているとし次のようになっているとします。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: このようなとき、このJavaScriptの資産をできるだけ変更せずに貨幣の型 (ユニオン型) を作ることができれば今後便利そうです。つまり次のようなユニオン型です。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '`typeof`[​](#typeof "typeof への直接リンク")'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: これはJavaScriptの`typeof`ではなくTypeScriptの`typeof`です。`typeof`はTypeScriptがその変数をどのような型であるかと認識しているかかを教えてくれます。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'ts`const  <data-lsp lsp="const currencies: string[]">currencies</data-lsp>  =
    ["CNY",  "EUR",  "GBP",  "JPY",  "KRW",  "USD"];type <data-lsp lsp="type Currency
    = string[]" style="border-bottom:solid 2px lightgrey">Currency</data-lsp> =  typeof
    <data-lsp lsp="const currencies: string[]">currencies</data-lsp>;` `type Currency
    = string[]`'
  prefs: []
  type: TYPE_NORMAL
- en: 予想されている方が多かったかもしれませんが`string[]`型と出てしまいました。ではこれをどうすれば`string`ではなく定数値で取得できるでしょうか。それは定数値で取得したいオブジェクトに`as
    const`をつけると取得できます。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'ts`const  <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>  =
    ["CNY",  "EUR",  "GBP",  "JPY",  "KRW",  "USD"] as  <data-lsp lsp="type const
    = readonly [&quot;CNY&quot;, &quot;EUR&quot;, &quot;GBP&quot;, &quot;JPY&quot;,
    &quot;KRW&quot;, &quot;USD&quot;]">const</data-lsp>;type <data-lsp lsp="type Currency
    = readonly [&quot;CNY&quot;, &quot;EUR&quot;, &quot;GBP&quot;, &quot;JPY&quot;,
    &quot;KRW&quot;, &quot;USD&quot;]" style="border-bottom:solid 2px lightgrey">Currency</data-lsp>
    =  typeof <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>;`
    `type Currency = readonly ["CNY", "EUR", "GBP", "JPY", "KRW", "USD"]`'
  prefs: []
  type: TYPE_NORMAL
- en: 定数 (リテラル型) は取れましたが依然配列のままです。これをユニオン型で取るためには考え方を逆転させる必要があります。
  prefs: []
  type: TYPE_NORMAL
- en: 何番目のリテラル型が欲しいか[​](#何番目のリテラル型が欲しいか "何番目のリテラル型が欲しいか への直接リンク")
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: たとえば`'GBP'`が欲しいとします。`'GBP'`は2番目なので`currencies`の2番目の型を取れば希望のリテラル型が取れます。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'ts`const  <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>  =
    ["CNY",  "EUR",  "GBP",  "JPY",  "KRW",  "USD"] as  <data-lsp lsp="type const
    = readonly [&quot;CNY&quot;, &quot;EUR&quot;, &quot;GBP&quot;, &quot;JPY&quot;,
    &quot;KRW&quot;, &quot;USD&quot;]">const</data-lsp>;type <data-lsp lsp="type Currency
    = &quot;GBP&quot;" style="border-bottom:solid 2px lightgrey">Currency</data-lsp>
    = (typeof <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>)[2];`
    `type Currency = "GBP"`'
  prefs: []
  type: TYPE_NORMAL
- en: '`''GBP''`を取ることができました。'
  prefs: []
  type: TYPE_NORMAL
- en: すべてのリテラル型が欲しい[​](#すべてのリテラル型が欲しい "すべてのリテラル型が欲しい への直接リンク")
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 本題です。まさか次のようにするわけには行かないのでもっと賢い方法を考える必要があります。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: そこで思いつくのは`typeof`をしているときのインデックスです。実はこれもリテラル型であり`currencies`の`2`のリテラル型を取ることを意味しています。
  prefs: []
  type: TYPE_NORMAL
- en: 配列はnumber型のインデックスに要素を代入しているオブジェクトなのでこのリテラル型のインデックスの代わりに`number`を使うことによって
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'ts`const  <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>  =
    ["CNY",  "EUR",  "GBP",  "JPY",  "KRW",  "USD"] as  <data-lsp lsp="type const
    = readonly [&quot;CNY&quot;, &quot;EUR&quot;, &quot;GBP&quot;, &quot;JPY&quot;,
    &quot;KRW&quot;, &quot;USD&quot;]">const</data-lsp>;type <data-lsp lsp="type Currency
    = &quot;CNY&quot; | &quot;EUR&quot; | &quot;GBP&quot; | &quot;JPY&quot; | &quot;KRW&quot;
    | &quot;USD&quot;" style="border-bottom:solid 2px lightgrey">Currency</data-lsp>
    = (typeof <data-lsp lsp="const currencies: readonly [&quot;CNY&quot;, &quot;EUR&quot;,
    &quot;GBP&quot;, &quot;JPY&quot;, &quot;KRW&quot;, &quot;USD&quot;]">currencies</data-lsp>)[number];`
    `type Currency = "CNY" | "EUR" | "GBP" | "JPY" | "KRW" | "USD"`'
  prefs: []
  type: TYPE_NORMAL
- en: と希望のユニオン型を取得できます。
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE

- en: defer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: defer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 'The `defer` statement is used to postpone a function call executed immediately
    before the surrounding function returns. The common uses of `defer` include releasing
    resources (i.e., unlock the mutex, close file handle.), do some tracing(i.e.,
    record the running time of function), etc. E.g., an ordinary accessing global
    variable exclusively is like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'An equivalent but concise format using `defer` is as follow:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: You can see this style is more simpler and easier to comprehend.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `defer` statements are executed in Last-In-First-Out sequence, which means
    the functions in latter `defer` statements run before their previous buddies.
    Check the following example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The running result is here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Although the function in `defer` statement runs very late, the parameters of
    the function are evaluated when the `defer` statement is executed.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The running result is here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Besides, if the deferred function is a function literal, it can also modify
    the return value:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: The value printed is `1000`, not `100`.
  prefs: []
  type: TYPE_NORMAL
- en: 'References:'
  prefs: []
  type: TYPE_NORMAL
- en: '[The Go Programming Language](http://www.gopl.io/);'
  prefs: []
  type: TYPE_NORMAL
- en: '[Defer, Panic, and Recover](https://blog.golang.org/defer-panic-and-recover).'
  prefs: []
  type: TYPE_NORMAL

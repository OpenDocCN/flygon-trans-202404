- en: Storage Devices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Lecture Notes for CS 140
  prefs: []
  type: TYPE_NORMAL
- en: Spring 2014
  prefs: []
  type: TYPE_NORMAL
- en: John Ousterhout
  prefs: []
  type: TYPE_NORMAL
- en: 'Readings for this topic from *Operating Systems: Principles and Practice*:
    Section 12.1.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Magnetic Disk (Hard Drive)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Basic geometry:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 1-5 *platters*, magnetically coated on each surface
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Platters spin at 5000-15000 RPM
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Actuator arm* positions *heads*, which can read and write data on the magnetic
    surfaces.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Overall size of disk package: 1-8 inches.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Organization of disk data:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Circular *tracks* corresponding to a particular position of the actuator arm.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Typical density today: 200,000 tracks per radial inch.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Tracks divided into 512-byte *sectors*. Typical tracks contain a few thousand
    sectors.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Typical total drive capacities: 100GB-2TB'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 100GB ~ 50M double-spaced pages of text.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Disk technology is one of the most rapidly advancing technologies: capacities
    increasing faster than Moore''s Law.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Reading and writing:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Seek*: move actuator arm to position heads over desired track. Typical seek
    time: 2-10ms.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Select a particular head.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Rotational latency*: wait for desired sector to pass under the head. One-half
    disk rotation on average (4ms @ 7500RPM)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Transfer: read or write one or more sectors as they pass under the head. Typical
    transfer rates: 100-150 MBytes/sec.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Latency* refers to the sum of seek time plus rotational latency; typically
    5-10ms.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'API for disks:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'In the old days the track and surface structure of the disk was visible to
    software:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Nowadays the track structure is hidden inside the disk:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Inner tracks have fewer sectors than outer tracks
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If some sectors are bad, disk software automatically remaps them to spare sectors.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Reel-to-Reel Magnetic Tape
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Old technology, popular in the 1960s and 1970s.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Magnetic tape:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 9 tracks across tape (one byte plus parity),
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 1/2" wide by 2400 feet long
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Variable-length records (20-30000 bytes); read or write blocks, but cannot write
    in middle
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Recording density up to 6250 bytes/inch (180 MBytes max for a tape)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Tape moves at 20-200 inches/sec. (up to a few Mbytes/sec.)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Interesting physical design, such as vacuum columns to buffer tape during fast
    start and stop.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Communicating with I/O Devices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*Device registers*:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each device appears in the physical address space of the machine as a few words,
    called *device registers*.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The operating system reads and writes device registers to control the device.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bits in device registers serve 3 purposes:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Parameters provided by CPU to device (e.g. number of first sector to read)
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Status bits provided by device to CPU (e.g. "operation complete" or "error occurred").
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Control bits set by CPU (e.g. "start disk read") to initiate operations.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Device registers don''t behave like ordinary memory locations:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '"Start operation" bit may always read as 0.'
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Bits may change without being written by CPU (e.g. "operation complete" bit).
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Programmed I/O*: all communication with I/O device occurs through the device
    registers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU writes device registers to start operation (e.g., read)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU polls ready bit in device register
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: When operation is finished, device sets ready
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU reads data from one or more device registers, writes data to memory.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Problems with this approach:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU wastes time waiting for data to become ready; can only keep one device busy
    at a time.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Expensive for CPU to mediate all data transfers; with some fast devices CPU
    can't keep up with device.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Interrupts*: allow CPU to do other work while devices are operating.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU starts I/O operation, then works on other things.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'When device needs attention (operation completes) it interrupts the CPU:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: A forced procedure call to a particular address in the kernel.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Operating system figures out which device interrupted, services that device.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Operating system returns from the interrupt back to whatever it was working
    on.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Interrupts make the operating system much more efficient; for example, can keep
    many devices busy at the same time, while also running user code.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Direct Memory Access* (DMA):'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Device can copy data to and from memory, without help from the CPU.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU loads buffer address into a device register before starting operation (e.g.,
    where to copy data read from disk).
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Device moves data directly to/from memory.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: When transfer complete, device issues an interrupt to the system.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Today DMA is the norm for I/O devices (controller hardware is cheap).
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL

- en: Directories and Links
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Lecture Notes for CS 140
  prefs: []
  type: TYPE_NORMAL
- en: Spring 2014
  prefs: []
  type: TYPE_NORMAL
- en: John Ousterhout
  prefs: []
  type: TYPE_NORMAL
- en: 'Readings for this topic from *Operating Systems: Principles and Practice*:
    Sections 13.1-13.2.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Naming: how do users refer to their files? How does OS find file, given name?'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'First step: file descriptor has to be stored on disk, so it will persist across
    system reboots.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Early UNIX versions: all descriptors stored in a fixed- size array on disk.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Originally entire descriptor array was at the outer edge of the disk. Result:
    long seeks between descriptors and file data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Later improvements:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Place descriptor array mid-way across disk.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Many small descriptor arrays spread across disk, so descriptors can be near
    to file data.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Space for descriptors is fixed when the disk is initialized, and can't be changed.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'UNIX/Linux/Pintos terms:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: File descriptor is called an *i-node*
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Index of i-node in the descriptor array: *i-number*. Internally the OS uses
    the i-number as an identifier for the file.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: When a file is open, its descriptor is kept in main memory. When the file is
    closed, the descriptor is stored back to disk.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'File naming: users want to use text names to refer to files. Special disk structures
    called *directories* are used to map names to descriptor indexes.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Early approaches to directory management:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A single directory for the entire disk:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If one user uses a particular name, no-one else can.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Many early personal computers worked this way.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A single directory for each user (e.g. TOPS-10):'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoids problems between users, but still makes it hard to organize information.
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Modern systems support hierarchical directory structures. UNIX/Linux approach:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Directories are stored on disk just like regular files (i.e. file descriptor
    with 14 pointers, etc.) except file descriptor has special flag bit set to indicate
    that it's a directory.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Each directory contains <*name*, *i-number*> pairs in no particular order.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The file pointed to by the i-number may be another directory. Hence, get hierarchical
    tree structure. Names have slashes separating the levels of the tree.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: There is one special directory, called the *root*. This directory has no name;
    it has i-number 2 (i-numbers 0 and 1 have other special purposes).
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: On some systems user programs can read directories just like regular files.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Only the operating system can write directories.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Working directories
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Cumbersome constantly to have to specify the full path name for all files.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Have OS remember one distinguished directory per process, called the *working
    directory*.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If a file name doesn't start with "/" then it is looked up starting in the working
    directory.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Names starting with "/" are looked up starting in the root directory.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Links
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*UNIX hard links*:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It is possible for more than one directory entry to refer to a single file.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: UNIX uses reference counts in file descriptors to keep track of hard links referring
    to a file.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Files are deleted when the last directory entry goes away.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Must prevent circularities.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Symbolic links*:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A file whose contents are another file name.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Stored on disk like regular files, but with special flag set in descriptor.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If a symbolic link is encountered during file lookup, switch to target named
    in symbolic link, continue lookup from there.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL

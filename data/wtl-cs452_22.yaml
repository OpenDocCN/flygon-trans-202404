- en: Lecture 22 - Courier, Warehouse
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 讲座22 - 快递员，仓库
- en: Public Service Annoucements
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 公共服务公告
- en: 'Exam: 9.00, August 8 to 11.30, August 9.'
  id: totrans-2
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 考试：8月8日上午9点至8月9日上午11:30。
- en: What is the earliest that anybody is planning to start?
  id: totrans-3
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有人计划最早何时开始？
- en: I now have back my document creation tools. Assignments will start to be more
    uptodate.
  id: totrans-4
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我现在拥有了我的文档创建工具。任务将开始更加及时更新。
- en: '* * *'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Anthropomorphic Programming
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 拟人化编程
- en: We all, even most programmers (!), have effective intuitions about human relations
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们所有人，甚至大多数程序员(!)，对人际关系有有效的直觉
- en: We use them to `understand' pets, which means attributing to them
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们用它们来`理解'宠物，这意味着归因于它们
- en: goals
  id: totrans-9
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标
- en: knowledge
  id: totrans-10
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 知识
- en: capability
  id: totrans-11
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 能力
- en: emotions
  id: totrans-12
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 情感
- en: Why not programs?
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么不是程序？
- en: apply them to intertask relationships
  id: totrans-14
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将它们应用于任务间关系
- en: Tasks are independent entities
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 任务是独立实体
- en: Understand them by thinking about them as if they have capabilities and goals.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过将它们视为具有能力和目标来理解它们。
- en: When you are developing something like the train application you are defining
    roles and relationships
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当你开发类似火车应用程序时，你正在定义角色和关系
- en: '* * *'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Servers and Attendant Tasks
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 服务器和辅助任务
- en: Why do servers need attendant tasks?
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器为什么需要辅助任务？
- en: What happens if a server calls AwaitEvent?
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果服务器调用AwaitEvent会发生什么？
- en: 1\. Proprietor with a Notifier
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1\. 拥有通知者的所有者
- en: Proprietor `owns' a service, which usually means a resource.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 所有者`拥有'一个服务，通常意味着一个资源。
- en: Think of the owner at the counter of an old-fashioned store
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想象一下柜台上的老式商店的所有者
- en: '`store'' means where things are stored;'
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`存储''意味着东西存放的地方;'
- en: it's in the back and only the proprietor can access it.
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它在后面，只有所有者可以访问它。
- en: Many clients come to the front and are processed one by one.
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 许多客户端来到前台，一个接一个地处理。
- en: Comment. The modern `store' is considered by many to be the most important innovation
    of the 20th century. (Yes, including the transistor, the computer, quantum mechanics,
    antibiotics, etc.) A whole lot of work that was previously done by store personnel
    is now done by the client. This is possible only because extensive codes of conduct
    have been internalized by clients. (That is, a large collection of new behaviour
    norms have been created and propagated.)
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评论。许多人认为现代的`存储'是20世纪最重要的创新。（是的，包括晶体管、计算机、量子力学、抗生素等。）以前由店员完成的大量工作现在由客户完成。这仅仅是因为客户已经内化了广泛的行为准则。（也就是说，已经创造并传播了大量新的行为规范。）
- en: Somebody has to sit out back waiting for the truck and bringing it to the proprietor
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 必须有人坐在后面等待卡车并将其带给所有者
- en: Kernel is handling hardware in this example
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 内核在这个例子中处理硬件
- en: Notifier Code for a UART
  id: totrans-31
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 用于UART的通知者代码
- en: Initialize
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE0]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Work
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE1]'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Proprietor Code for a UART
  id: totrans-36
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 用于UART的所有者代码
- en: Initialize
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE2]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Work
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE3]'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Notes
  id: totrans-41
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注释
- en: Notifier is usually of higher priority than server
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通知者通常比服务器优先级高
- en: Notice the early reply in the proprietor
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注意所有者的早期回复
- en: When, and how, do interrupts get turned on and/or cleared?
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 何时以及如何打开和/或清除中断？
- en: Who coordinates hardware ownership?
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 谁协调硬件所有权？
- en: We have made the code
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们已经编写了代码
- en: exhibit duality explicitly
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 明确展示二元性
- en: easy to break into parts
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容易分解成部分
- en: easy to extend
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 易于扩展
- en: '* * *'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 2\. Using a Courier
  id: totrans-51
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2\. 使用快递员
- en: Simplest is best
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 简单就是最好的
- en: Transmit Notifier Code
  id: totrans-53
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 传输通知者代码
- en: Initialize
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE4]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Work
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE5]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This omits flow control. Is it better to handle flow control in the notifier
    or in the server?
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这省略了流程控制。在通知者还是服务器中处理流程控制更好？
- en: That is, where should the fifo be?
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 也就是说，fifo应该放在哪里？
- en: Transmit Courier Code
  id: totrans-60
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 传输快递员代码
- en: Initialize
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE6]'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Work
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE7]'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Transmit Proprietor Code
  id: totrans-65
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 传输所有者代码
- en: Initialize
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE8]'
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Work
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE9]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Notes
  id: totrans-70
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注释
- en: This gets you through a bottleneck where no more than two events come too fast.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 这让你通过一个瓶颈，不会有超过两个事件发生得太快。
- en: Remember that all the calls provide error returns. You can/should use them for
    error recovery
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，所有的调用都提供错误返回。你可以/应该用它们来进行错误恢复。
- en: 'static error recovery: debugging'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 静态错误恢复：调试
- en: 'dynamic error recovery: at run time'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动态错误恢复：在运行时
- en: Another possible arrangement for task creation
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 任务创建的另一种可能安排
- en: Server creates the courier
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器创建快递员
- en: Couier creates the notifier
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 快递员创建通知者
- en: Another possible arrangement for initialization
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 初始化的另一种可能安排
- en: Server Receives
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器接收
- en: Courier sends to its parentTid
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 快递员发送给其父Tid
- en: Notifier sends to its parentTid
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通知者发送给其父Tid
- en: Distributed gating
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 分布式门控
- en: I am showing you collections of tasks implemented together because sets of related
    tasks is a level of organization above the individual task.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我正在向您展示一起实现的任务集合，因为相关任务集合是高于单个任务的组织级别。
- en: E.g., the decision to add a courier requires revision of code within the group,
    but not outside it.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，决定添加一个快递员需要对组内的代码进行修订，但不需要对外部进行修订。
- en: 3\. Using a Warehouse
  id: totrans-85
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 3\. 使用仓库
- en: Add a warehouse between the courier and the notifier.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在快递员和通知者之间添加一个仓库。
- en: Notifier Code
  id: totrans-87
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 通知者代码
- en: Initialize
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE10]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Work
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE11]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Warehouse Code
  id: totrans-92
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 仓库代码
- en: Initialize
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE12]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Work
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE13]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Transmit Courier Code
  id: totrans-97
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 传输快递员代码
- en: Initialize
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE14]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Work
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE15]'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Proprietor Code
  id: totrans-102
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 所有者代码
- en: Initialize
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化
- en: '[PRE16]'
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Work
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: '[PRE17]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Note
  id: totrans-107
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: This structure clears up most problems when a burst of requests to the server
    would leave the notifier waiting in a long sendQ..
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 当对服务器的一连串请求导致通知者在长的sendQ中等待时，这种结构可以解决大多数问题。
- en: Warehouse and proprietor share the work.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仓库和所有者共同分担工作。
- en: Server's Tid is public; Warehouse's Tid is private.
  id: totrans-110
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器的Tid是公开的；仓库的Tid是私有的。
- en: This is far from the only way to share the work. For example,
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这远非是分享工作的唯一方式。例如，
- en: The server could be guarded by a receptionist (assistant) who ensures that another
    client request occurs only when the previous request is complete. Then the warehouse
    is unnecessary.
  id: totrans-112
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器可以由一个确保只有在前一个请求完成时才会发生另一个客户端请求的接待员（助手）保护。然后仓库就是不必要的。
- en: 'Two issues:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 两个问题：
- en: Handles bottlenecks of all sizes.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 处理各种大小的瓶颈。
- en: Give a precise and quantitative definition of `bottleneck'.
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 给出“瓶颈”的精确和定量定义。
- en: Server could be buffered on the other side
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 服务器可以在另一侧进行缓冲
- en: Called a guard.
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 被称为守卫。
- en: What this amounts to is that a server should be lean and hungry
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着服务器应该精益求精，保持饥饿
- en: do as little as possible
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽量做得少
- en: always be receive blocked
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 始终处于接收阻塞状态
- en: '* * *'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Return to:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到：
- en: '[Bill Cowan''s lecture notes for CS452 in s12](index.html)'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[比尔·考恩2012年春季CS452讲座笔记](index.html)'
- en: '[Bill Cowan''s Spring 2012 CS452 page](../index.html)'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[比尔·考恩2012年春季CS452页面](../index.html)'
- en: '[Bill Cowan''s CS452 page](../../index.html)'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[比尔·考恩的CS452页面](../../index.html)'
- en: '[Bill Cowan''s teaching page](../../../index.html)'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[比尔·考恩的教学页面](../../../index.html)'
- en: '[Bill Cowan''s home page](../../../../index.html)'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[比尔·考恩的主页](../../../../index.html)'
